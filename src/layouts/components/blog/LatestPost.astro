---
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";

interface Props {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props satisfies Props;

// Función para formatear fecha
const formatDate = (date: Date): string => {
  return date.toLocaleDateString("es-ES", {
    year: "numeric",
    month: "long", 
    day: "numeric",
  });
};

// URL del post completo
const postUrl = `/blog/${post.id}`;
---

<section class="latest-post-hero py-20 bg-gradient-to-br from-[rgb(var(--color-primary))] via-[rgb(var(--color-secondary))] to-[rgb(var(--color-neutral))]">
  <div class="container mx-auto px-4">
    
    <!-- Etiqueta de "Último artículo" -->
    <div class="text-center mb-8">
      <span class="inline-block bg-white/20 backdrop-blur-sm text-white px-4 py-2 rounded-full text-sm font-semibold">
        ✨ Último Artículo Publicado
      </span>
    </div>

    <div class="grid lg:grid-cols-2 gap-12 items-center max-w-6xl mx-auto">
      
      <!-- Contenido del post -->
      <div class="text-white space-y-6 order-2 lg:order-1">
        
        <!-- Meta información -->
        <div class="flex items-center gap-6 text-sm text-white/80">
          <time datetime={post.data.pubDate.toISOString()} class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
            </svg>
            {formatDate(post.data.pubDate)}
          </time>
          
          {post.data.readingTime && (
            <span class="flex items-center gap-2">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.7L16.2,16.2Z"/>
              </svg>
              {post.data.readingTime} min de lectura
            </span>
          )}
        </div>

        <!-- Título del post -->
        <h1 class="text-3xl lg:text-5xl font-bold leading-tight">
          {post.data.title}
        </h1>

        <!-- Descripción -->
        <p class="text-lg lg:text-xl text-white/90 leading-relaxed">
          {post.data.description}
        </p>

        <!-- Tags principales -->
        {post.data.tags && post.data.tags.length > 0 && (
          <div class="flex flex-wrap gap-3">
            {post.data.tags.slice(0, 3).map((tag) => (
              <span class="bg-white/20 backdrop-blur-sm text-white px-3 py-1 rounded-full text-sm">
                #{tag}
              </span>
            ))}
          </div>
        )}

        <!-- Autor -->
        {post.data.author && (
          <div class="flex items-center gap-3 text-white/80">
            <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
              </svg>
            </div>
            <span class="font-medium">{post.data.author}</span>
          </div>
        )}

        <!-- Call to action -->
        <div class="pt-4">
          <a 
            href={postUrl}
            class="inline-flex items-center gap-3 bg-white text-[rgb(var(--color-primary))] px-8 py-4 rounded-xl font-semibold text-lg hover:bg-gray-50 transition-all duration-300 hover:scale-105 hover:shadow-xl group"
          >
            Leer artículo completo
            <svg class="w-6 h-6 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </div>

      </div>

      <!-- Imagen del post -->
      <div class="order-1 lg:order-2">
        {post.data.heroImage ? (
          <div class="relative">
            <Image
              src={post.data.heroImage}
              alt={post.data.heroImageAlt || post.data.title}
              width={600}
              height={400}
              class="w-full h-auto rounded-2xl shadow-2xl"
              loading="eager"
            />
            
            <!-- Badge de categoría -->
            <div class="absolute top-6 left-6">
              <span class="bg-[rgb(var(--color-accent))] text-gray-900 px-4 py-2 rounded-full text-sm font-bold">
                {post.data.category}
              </span>
            </div>
            
            <!-- Badge destacado si aplica -->
            {post.data.featured && (
              <div class="absolute top-6 right-6">
                <span class="bg-yellow-400 text-gray-900 px-3 py-1 rounded-full text-sm font-bold">
                  ⭐ Destacado
                </span>
              </div>
            )}
          </div>
        ) : (
          <!-- Placeholder si no hay imagen -->
          <div class="w-full h-96 bg-white/10 backdrop-blur-sm rounded-2xl flex items-center justify-center">
            <div class="text-center text-white/60">
              <svg class="w-24 h-24 mx-auto mb-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19M19,19H5V5H19M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5L13.96,12.29Z"/>
              </svg>
              <p class="text-lg font-medium">Artículo sin imagen</p>
            </div>
          </div>
        )}
      </div>

    </div>

    <!-- Indicador de scroll hacia abajo -->
    <div class="text-center mt-16">
      <div class="inline-flex flex-col items-center text-white/60">
        <span class="text-sm mb-2">Continúa leyendo</span>
        <svg class="w-6 h-6 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
        </svg>
      </div>
    </div>

  </div>
</section>

<style>
  /* Efecto de parallax sutil en el fondo */
  .latest-post-hero {
    background-attachment: fixed;
    background-size: cover;
    position: relative;
  }

  /* Overlay sutil para mejorar legibilidad */
  .latest-post-hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.1);
    pointer-events: none;
  }

  /* Animación del botón CTA */
  @keyframes pulse-shadow {
    0%, 100% {
      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
    }
    50% {
      box-shadow: 0 0 0 10px rgba(255, 255, 255, 0);
    }
  }

  .latest-post-hero a:hover {
    animation: pulse-shadow 1.5s infinite;
  }
</style>